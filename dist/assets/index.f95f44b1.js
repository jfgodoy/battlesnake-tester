import{c as e,t,s as n,a as r,b as s,d as i,i as o,e as a,S as l,f as c,g as d,M as u,h as _,j as f,u as m,m as p,p as h,k as g,l as v,n as b,o as y,q as E,F as w,$ as x,r as T,v as R,z as $,w as L,x as D,y as k,A,B as O,C as I}from"./vendor.b0d0fef8.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const j={},P=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in j)return;j[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((e,t)=>{r.addEventListener("load",e),r.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};var V={alligator:()=>P((()=>import("./alligator.2f928d0f.js")),["assets/alligator.2f928d0f.js","assets/vendor.b0d0fef8.js"]),beluga:()=>P((()=>import("./beluga.152581cd.js")),["assets/beluga.152581cd.js","assets/vendor.b0d0fef8.js"]),bendr:()=>P((()=>import("./bendr.7ccfc19b.js")),["assets/bendr.7ccfc19b.js","assets/vendor.b0d0fef8.js"]),bonhomme:()=>P((()=>import("./bonhomme.bff575e9.js")),["assets/bonhomme.bff575e9.js","assets/vendor.b0d0fef8.js"]),caffeine:()=>P((()=>import("./caffeine.400e841c.js")),["assets/caffeine.400e841c.js","assets/vendor.b0d0fef8.js"]),chomp:()=>P((()=>import("./chomp.f6df92fa.js")),["assets/chomp.f6df92fa.js","assets/vendor.b0d0fef8.js"]),comet:()=>P((()=>import("./comet.69780591.js")),["assets/comet.69780591.js","assets/vendor.b0d0fef8.js"]),dead:()=>P((()=>import("./dead.b99f520e.js")),["assets/dead.b99f520e.js","assets/vendor.b0d0fef8.js"]),default:()=>P((()=>import("./default.e6c3379d.js")),["assets/default.e6c3379d.js","assets/vendor.b0d0fef8.js"]),earmuffs:()=>P((()=>import("./earmuffs.def0c33a.js")),["assets/earmuffs.def0c33a.js","assets/vendor.b0d0fef8.js"]),evil:()=>P((()=>import("./evil.3d736281.js")),["assets/evil.3d736281.js","assets/vendor.b0d0fef8.js"]),fang:()=>P((()=>import("./fang.a3a30107.js")),["assets/fang.a3a30107.js","assets/vendor.b0d0fef8.js"]),football:()=>P((()=>import("./football.df9c9b17.js")),["assets/football.df9c9b17.js","assets/vendor.b0d0fef8.js"]),gamer:()=>P((()=>import("./gamer.9b66b7a2.js")),["assets/gamer.9b66b7a2.js","assets/vendor.b0d0fef8.js"]),iguana:()=>P((()=>import("./iguana.7761cd97.js")),["assets/iguana.7761cd97.js","assets/vendor.b0d0fef8.js"]),jackolantern:()=>P((()=>import("./jackolantern.47f9424e.js")),["assets/jackolantern.47f9424e.js","assets/vendor.b0d0fef8.js"]),"lantern-fish":()=>P((()=>import("./lantern-fish.16ffaa90.js")),["assets/lantern-fish.16ffaa90.js","assets/vendor.b0d0fef8.js"]),mask:()=>P((()=>import("./mask.10394507.js")),["assets/mask.10394507.js","assets/vendor.b0d0fef8.js"]),missile:()=>P((()=>import("./missile.4143646e.js")),["assets/missile.4143646e.js","assets/vendor.b0d0fef8.js"]),"moto-helmet":()=>P((()=>import("./moto-helmet.81e34433.js")),["assets/moto-helmet.81e34433.js","assets/vendor.b0d0fef8.js"]),moustache:()=>P((()=>import("./moustache.bd8dc47c.js")),["assets/moustache.bd8dc47c.js","assets/vendor.b0d0fef8.js"]),orca:()=>P((()=>import("./orca.fa2940cc.js")),["assets/orca.fa2940cc.js","assets/vendor.b0d0fef8.js"]),"pixel-round":()=>P((()=>import("./pixel-round.2ad68958.js")),["assets/pixel-round.2ad68958.js","assets/vendor.b0d0fef8.js"]),pixel:()=>P((()=>import("./pixel.9f340fc9.js")),["assets/pixel.9f340fc9.js","assets/vendor.b0d0fef8.js"]),pumpkin:()=>P((()=>import("./pumpkin.90017e2d.js")),["assets/pumpkin.90017e2d.js","assets/vendor.b0d0fef8.js"]),"rbc-bowler":()=>P((()=>import("./rbc-bowler.f073f82c.js")),["assets/rbc-bowler.f073f82c.js","assets/vendor.b0d0fef8.js"]),"replit-mark":()=>P((()=>import("./replit-mark.1d6245f2.js")),["assets/replit-mark.1d6245f2.js","assets/vendor.b0d0fef8.js"]),"rocket-helmet":()=>P((()=>import("./rocket-helmet.e338c244.js")),["assets/rocket-helmet.e338c244.js","assets/vendor.b0d0fef8.js"]),rudolph:()=>P((()=>import("./rudolph.0f18b7e4.js")),["assets/rudolph.0f18b7e4.js","assets/vendor.b0d0fef8.js"]),safe:()=>P((()=>import("./safe.468ddc73.js")),["assets/safe.468ddc73.js","assets/vendor.b0d0fef8.js"]),"sand-worm":()=>P((()=>import("./sand-worm.a9d17f7f.js")),["assets/sand-worm.a9d17f7f.js","assets/vendor.b0d0fef8.js"]),scarf:()=>P((()=>import("./scarf.680b64c8.js")),["assets/scarf.680b64c8.js","assets/vendor.b0d0fef8.js"]),shades:()=>P((()=>import("./shades.cd00c569.js")),["assets/shades.cd00c569.js","assets/vendor.b0d0fef8.js"]),silly:()=>P((()=>import("./silly.8f3660bd.js")),["assets/silly.8f3660bd.js","assets/vendor.b0d0fef8.js"]),ski:()=>P((()=>import("./ski.63a903c7.js")),["assets/ski.63a903c7.js","assets/vendor.b0d0fef8.js"]),smile:()=>P((()=>import("./smile.07499ce3.js")),["assets/smile.07499ce3.js","assets/vendor.b0d0fef8.js"]),snail:()=>P((()=>import("./snail.36789ee9.js")),["assets/snail.36789ee9.js","assets/vendor.b0d0fef8.js"]),sneaky:()=>P((()=>import("./sneaky.18fd14cb.js")),["assets/sneaky.18fd14cb.js","assets/vendor.b0d0fef8.js"]),"snow-worm":()=>P((()=>import("./snow-worm.c6029cc8.js")),["assets/snow-worm.c6029cc8.js","assets/vendor.b0d0fef8.js"]),snowman:()=>P((()=>import("./snowman.93e67cc4.js")),["assets/snowman.93e67cc4.js","assets/vendor.b0d0fef8.js"]),"space-helmet":()=>P((()=>import("./space-helmet.0981dceb.js")),["assets/space-helmet.0981dceb.js","assets/vendor.b0d0fef8.js"]),"tiger-king":()=>P((()=>import("./tiger-king.f532c248.js")),["assets/tiger-king.f532c248.js","assets/vendor.b0d0fef8.js"]),tongue:()=>P((()=>import("./tongue.11eec656.js")),["assets/tongue.11eec656.js","assets/vendor.b0d0fef8.js"]),villain:()=>P((()=>import("./villain.4d41b45e.js")),["assets/villain.4d41b45e.js","assets/vendor.b0d0fef8.js"]),viper:()=>P((()=>import("./viper.d26dfe05.js")),["assets/viper.d26dfe05.js","assets/vendor.b0d0fef8.js"]),workout:()=>P((()=>import("./workout.807797b1.js")),["assets/workout.807797b1.js","assets/vendor.b0d0fef8.js"])},S={alligator:()=>P((()=>import("./alligator.e477a8c5.js")),["assets/alligator.e477a8c5.js","assets/vendor.b0d0fef8.js"]),"block-bum":()=>P((()=>import("./block-bum.9b4113a8.js")),["assets/block-bum.9b4113a8.js","assets/vendor.b0d0fef8.js"]),bolt:()=>P((()=>import("./bolt.2c9feadf.js")),["assets/bolt.2c9feadf.js","assets/vendor.b0d0fef8.js"]),bonhomme:()=>P((()=>import("./bonhomme.163cba52.js")),["assets/bonhomme.163cba52.js","assets/vendor.b0d0fef8.js"]),coffee:()=>P((()=>import("./coffee.66d7e3b3.js")),["assets/coffee.66d7e3b3.js","assets/vendor.b0d0fef8.js"]),comet:()=>P((()=>import("./comet.8306d880.js")),["assets/comet.8306d880.js","assets/vendor.b0d0fef8.js"]),curled:()=>P((()=>import("./curled.d60b037f.js")),["assets/curled.d60b037f.js","assets/vendor.b0d0fef8.js"]),default:()=>P((()=>import("./default.6705d848.js")),["assets/default.6705d848.js","assets/vendor.b0d0fef8.js"]),"fat-rattle":()=>P((()=>import("./fat-rattle.3b55b52e.js")),["assets/fat-rattle.3b55b52e.js","assets/vendor.b0d0fef8.js"]),fish:()=>P((()=>import("./fish.1babd8ed.js")),["assets/fish.1babd8ed.js","assets/vendor.b0d0fef8.js"]),flake:()=>P((()=>import("./flake.8e2087f4.js")),["assets/flake.8e2087f4.js","assets/vendor.b0d0fef8.js"]),flame:()=>P((()=>import("./flame.2d52d578.js")),["assets/flame.2d52d578.js","assets/vendor.b0d0fef8.js"]),football:()=>P((()=>import("./football.6bef76a1.js")),["assets/football.6bef76a1.js","assets/vendor.b0d0fef8.js"]),freckled:()=>P((()=>import("./freckled.2c037ce3.js")),["assets/freckled.2c037ce3.js","assets/vendor.b0d0fef8.js"]),ghost:()=>P((()=>import("./ghost.98ecf5f0.js")),["assets/ghost.98ecf5f0.js","assets/vendor.b0d0fef8.js"]),hook:()=>P((()=>import("./hook.828da997.js")),["assets/hook.828da997.js","assets/vendor.b0d0fef8.js"]),"ice-skate":()=>P((()=>import("./ice-skate.00a16ea9.js")),["assets/ice-skate.00a16ea9.js","assets/vendor.b0d0fef8.js"]),iguana:()=>P((()=>import("./iguana.1d20214a.js")),["assets/iguana.1d20214a.js","assets/vendor.b0d0fef8.js"]),ion:()=>P((()=>import("./ion.6484d4d4.js")),["assets/ion.6484d4d4.js","assets/vendor.b0d0fef8.js"]),leaf:()=>P((()=>import("./leaf.0ca814eb.js")),["assets/leaf.0ca814eb.js","assets/vendor.b0d0fef8.js"]),missile:()=>P((()=>import("./missile.83bc25bd.js")),["assets/missile.83bc25bd.js","assets/vendor.b0d0fef8.js"]),mouse:()=>P((()=>import("./mouse.fdd3b800.js")),["assets/mouse.fdd3b800.js","assets/vendor.b0d0fef8.js"]),"pixel-round":()=>P((()=>import("./pixel-round.ffd9cb76.js")),["assets/pixel-round.ffd9cb76.js","assets/vendor.b0d0fef8.js"]),pixel:()=>P((()=>import("./pixel.927b88a9.js")),["assets/pixel.927b88a9.js","assets/vendor.b0d0fef8.js"]),present:()=>P((()=>import("./present.10bd2765.js")),["assets/present.10bd2765.js","assets/vendor.b0d0fef8.js"]),pumpkin:()=>P((()=>import("./pumpkin.3fe40203.js")),["assets/pumpkin.3fe40203.js","assets/vendor.b0d0fef8.js"]),rattle:()=>P((()=>import("./rattle.17def76a.js")),["assets/rattle.17def76a.js","assets/vendor.b0d0fef8.js"]),"rbc-necktie":()=>P((()=>import("./rbc-necktie.14dea96a.js")),["assets/rbc-necktie.14dea96a.js","assets/vendor.b0d0fef8.js"]),"replit-notmark":()=>P((()=>import("./replit-notmark.44c418b8.js")),["assets/replit-notmark.44c418b8.js","assets/vendor.b0d0fef8.js"]),rocket:()=>P((()=>import("./rocket.3f4eeab1.js")),["assets/rocket.3f4eeab1.js","assets/vendor.b0d0fef8.js"]),"round-bum":()=>P((()=>import("./round-bum.fad7d95c.js")),["assets/round-bum.fad7d95c.js","assets/vendor.b0d0fef8.js"]),sharp:()=>P((()=>import("./sharp.78bc6318.js")),["assets/sharp.78bc6318.js","assets/vendor.b0d0fef8.js"]),"skinny-jeans":()=>P((()=>import("./skinny-jeans.7fb38f46.js")),["assets/skinny-jeans.7fb38f46.js","assets/vendor.b0d0fef8.js"]),skinny:()=>P((()=>import("./skinny.d3bb593e.js")),["assets/skinny.d3bb593e.js","assets/vendor.b0d0fef8.js"]),"small-rattle":()=>P((()=>import("./small-rattle.c7f7d530.js")),["assets/small-rattle.c7f7d530.js","assets/vendor.b0d0fef8.js"]),snail:()=>P((()=>import("./snail.30ca300c.js")),["assets/snail.30ca300c.js","assets/vendor.b0d0fef8.js"]),swirl:()=>P((()=>import("./swirl.1d83ae57.js")),["assets/swirl.1d83ae57.js","assets/vendor.b0d0fef8.js"]),swoop:()=>P((()=>import("./swoop.635a0681.js")),["assets/swoop.635a0681.js","assets/vendor.b0d0fef8.js"]),"tiger-tail":()=>P((()=>import("./tiger-tail.cbcc71cf.js")),["assets/tiger-tail.cbcc71cf.js","assets/vendor.b0d0fef8.js"]),tire:()=>P((()=>import("./tire.15b0e899.js")),["assets/tire.15b0e899.js","assets/vendor.b0d0fef8.js"]),virus:()=>P((()=>import("./virus.64305559.js")),["assets/virus.64305559.js","assets/vendor.b0d0fef8.js"]),weight:()=>P((()=>import("./weight.8acb2f7e.js")),["assets/weight.8acb2f7e.js","assets/vendor.b0d0fef8.js"])};const N={heads:{},tails:{}};async function C(e){if(N.heads[e])return N.heads[e];const t=V[e]||V.default,n=(await t()).default;return N.heads[e]=n,n}async function B(e){if(N.tails[e])return N.tails[e];const t=S[e]||S.default,n=(await t()).default;return N.tails[e]=n,n}function U(e){if(N.heads[e])return N.heads[e];throw new Error("head not found")}function H(e){if(N.tails[e])return N.tails[e];throw new Error("tail not found")}var M="_snake_pfrd6_1",F="_head_pfrd6_6",Y="_body_pfrd6_12",G="_tail_pfrd6_18";const q=t("<div><span></span><span></span><span></span></div>"),z=t=>{const[c,d]=n(t,["color","head","tail"]),[u]=r((async()=>({Head:await C(t.head),Tail:await B(t.tail)})));return s(l,{get when(){return u()},children:({Head:n,Tail:r})=>(()=>{const l=q.cloneNode(!0),c=l.firstChild,u=c.nextSibling,_=u.nextSibling;return i(l,d,!1,!0),o(c,s(r,{get fill(){return t.color}})),o(_,s(n,{get fill(){return t.color}})),e((e=>{const n={flex:!0,[M]:!0},r=G,s=Y,i=t.color,o=F;return e._v$=a(l,n,e._v$),r!==e._v$2&&(c.className=e._v$2=r),s!==e._v$3&&(u.className=e._v$3=s),i!==e._v$4&&u.style.setProperty("background-color",e._v$4=i),o!==e._v$5&&(_.className=e._v$5=o),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),l})()})},W=t("<span>loading...</span>"),X=t('<div class="flex items-center"><span class="font-bold text-gray-500">Server:</span><input class="ml-1 px-3 rounded bg-gray-100 text-gray-700 round min-w-44 w-0"><button class="bg-blue-400 text-white ml-8 px-2 font-bold rounded">Import Game</button></div>'),J=t('<span class="text-red-400 font-bold">Error: </span>'),K=t('<button class="border border-gray-400 rounded text-xs px-2 ml-3 text-gray-600">retry</button>');function Q(t){const[n,i]=t.server,[a,l]=t.style,[c,{refetch:f}]=r(n,(async e=>{const t=await fetch(e).then((e=>e.json())),{color:n,head:r,tail:s}=t;return{color:n,head:r,tail:s}}));return d((()=>l(c.loading||c.error?void 0:c()))),(()=>{const r=X.cloneNode(!0),l=r.firstChild.nextSibling,d=l.nextSibling;return function(t,n){const r=n();e((()=>t.value=r.get())),t.addEventListener(r.updateOn,(e=>r.set(e.target.value)))}(l,(()=>({get:n,set:i,updateOn:"blur"}))),function(e){let t=e.value;e.addEventListener("input",(()=>{t.length>e.value.length&&(e.style.width="0"),e.style.width=`${e.scrollWidth}px`,t=e.value}))}(l),o(r,s(_,{get children(){return[s(u,{get when(){return c.loading},get children(){return W.cloneNode(!0)}}),s(u,{get when(){return c.error},children:e=>[(()=>{const t=J.cloneNode(!0);return t.firstChild,o(t,(()=>e.message),null),t})(),(()=>{const e=K.cloneNode(!0);return e.$$click=()=>f(),e})()]}),s(u,{get when(){return a()},children:e=>s(z,{class:"mx-2",get color(){return e.color},get head(){return e.head},get tail(){return e.tail}})})]}}),d),d.$$click=()=>t.setView("importer"),r})()}function Z(e){return function(e){e.Turn=e.Turn||0;for(const t of e.Snakes)for(const e of t.Body)e.X=e.X||0,e.Y=e.Y||0;for(const t of e.Food)t.X=t.X||0,t.Y=t.Y||0}(e),{turn:e.Turn,snakes:e.Snakes.map(ee),food:e.Food.map(ne),hazards:e.Hazards.map(ne)}}function ee(e){return{id:e.ID,name:e.Name,body:e.Body.map(ne),color:e.Color,health:e.Health,latency:e.Latency,death:te(e.Death),headType:e.HeadType&&e.HeadType.toLowerCase()||"default",tailType:e.TailType&&e.TailType.toLowerCase()||"default",squad:e.Squad,author:e.Author,shout:e.Shout,url:e.URL}}function te(e){if(e)return{cause:e.Cause,turn:e.Turn||0,eliminatedBy:e.EliminatedBy}}function ne(e){return{x:e.X,y:e.Y}}c(["click"]);async function re(e){const t=`https://engine.battlesnake.com/games/${e}`,n=await async function(e){const t=await fetch(e);return 200===t.status?Promise.resolve(t.json()):Promise.resolve(t.json()).then((e=>(console.error(e.error),Promise.reject(e.error))))}(t),r=`wss://engine.battlesnake.com/socket/${e}`;return{game:{id:n.Game.ID,ruleset:{name:n.Game.Ruleset.name,version:"v.1.2.3"},width:n.Game.Width,height:n.Game.Height,timeout:n.Game.SnakeTimeout},frames:await function(e,t){const n=new Map;return new Promise(((r,s)=>{const i=new WebSocket(e);i.addEventListener("message",(({data:e})=>{try{const r=JSON.parse(e),s=t(r);n.set(s.turn.toString(),s)}catch(r){s(r)}})),i.addEventListener("close",(function(){const e=f(((e,t)=>e.turn-t.turn),[...n.values()]),t=e.length-1;e[t].turn!==t?s(new Error("missing some frames")):r(e)}))}))}(r,Z)}}let se;var ie;function oe(e){return{type:"ok",value:e}}function ae(e){return{type:"error",msg:e}}(ie=se||(se={}))[ie.Up=0]="Up",ie[ie.Down=1]="Down",ie[ie.Left=2]="Left",ie[ie.Right=3]="Right";const le=se.Up;async function ce(e){const t=m(p(h("headType"),e)),n=m(p(h("tailType"),e));await Promise.all(t.map(C)),await Promise.all(n.map(B))}function de(e){const t=e.body.filter(((t,n)=>ue(e,n)));return Object.assign({},e,{parts:e.body.map(((t,n)=>function(e,t){const n=e.body[t],r=function(e,t){if(0===t)return fe.HEAD;if(t===e.body.length-1)return fe.TAIL;return fe.BODY}(e,t),{x:s,y:i}=n,o=function(e,t,n,r){let s;if(e===fe.HEAD)s=_e(t.body[1],t.body[0]);else{let e;do{e=t.body[Math.max(r-1,0)],--r}while(r>0&&e.x===n.x&&e.y===n.y);s=_e(n,e)}return s}(r,e,n,t),a=!ue(e,t)||void 0;return{direction:o,type:r,isOverlapped:a,x:s,y:i,shadeForOverlap:!1}}(e,n))),effectiveSpace:t.length,headSvg:U(e.headType)(),tailSvg:H(e.tailType)()})}function ue(e,t){const n=e.body.length-1,r=e.body[0],s=e.body[n],i=e.body[t];if(0===t)return!0;if(t===n)return!(r.x===i.x&&r.y===i.y);const o=e.body[t-1];return!(s.x===i.x&&s.y===i.y||r.x===i.x&&r.y===i.y||o&&o.x===i.x&&o.y===i.y)}function _e(e,t){return e.x<t.x?se.Right:e.x>t.x?se.Left:e.y>t.y?se.Down:e.y<t.y?se.Up:le}let fe;var me;function pe(e){return{id:e.id,name:e.name,health:e.health,body:e.body,latency:+e.latency,head:e.body[0],length:e.body.length,shout:e.shout,squad:e.squad}}async function he(e,t){const n=t.frames.find((e=>e.turn==t.frameToTest));if(!n)return{type:"failed",msg:"frame to test not found"};const r=pe(n.snakes[t.snakeToTest]),s=n.snakes.filter((e=>!e.death)).map(pe),i={board:{food:n.food,snakes:s,width:t.game.width,height:t.game.height},game:{id:t.game.id,ruleset:t.game.ruleset,timeout:t.game.timeout},turn:n.turn,you:r},o=await function(e,t){const n={body:JSON.stringify(t),method:"POST",mode:"cors",headers:[["content-type","application/json"]]};return fetch(e,n).then((e=>e.json())).then((e=>{switch(e.move){case"up":return oe(se.Up);case"down":return oe(se.Down);case"left":return oe(se.Left);case"right":return oe(se.Right);default:return ae("invalid move")}})).catch((e=>(console.log(e),ae("invalid move"))))}(e,i),a=t.expectedResult;switch(o.type){case"ok":{const e=se[o.value];return a.indexOf(e)>=0?{type:"passed",move:e}:{type:"failed",move:e,msg:"incorrect move"}}case"error":return{type:"failed",msg:o.msg}}}(me=fe||(fe={}))[me.HEAD=0]="HEAD",me[me.TAIL=1]="TAIL",me[me.BODY=2]="BODY";const ge="#f1f1f1",ve="#D6D5EA",be="#ff5c75",ye="#000000",Ee="0.4",we="#AAAAAA",xe="dark",Te="light",Re=t("<svg><g><svg><g></g></svg></g></svg>",8,!0),$e=t("<svg><rect></rect></svg>",4,!0),Le=t("<svg><path></path></svg>"),De=t("<svg><g></g></svg>"),ke=t("<svg></svg>"),Ae=t("<svg><circle></circle></svg>",4,!0),Oe=(20/3.25).toFixed(2),Ie=[se.Up,se.Right,se.Down,se.Left];var je,Pe;function Ve(e){return 24*e+4}function Se(e,t){return 24*(t-1-e)+4}function Ne(e){return!!e.death}function Ce(e){return e.shadeForOverlap?.8:e.isOverlapped?.3:1}function Be(e,t){return t.shadeForOverlap?we:e.color}function Ue(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}function He(e,t){if(0===t||t===e.parts.length-1)return!1;const n=e.parts[t+1],r=e.parts[t];return(n.x!==r.x||n.y!==r.y)&&(s=r.direction,i=n.direction,Math.abs(Ie.indexOf(s)-Ie.indexOf(i))%2==1);var s,i}function Me(e,t){const n=e.body[e.body.length-1];return t.isOverlapped&&n.x===t.x&&n.y===t.y}function Fe(t,n,r,s,i){if(!Me(t,r))switch(r.type){case fe.HEAD:return function(t,n,r,s){const i=function(e){switch(e.direction){case se.Left:return Ve(e.x)+.2;case se.Right:return Ve(e.x)-.2;default:return Ve(e.x)}}(r),a=function(e,t){switch(e.direction){case se.Up:return Se(e.y,t)+.2;case se.Down:return Se(e.y,t)-.2;default:return Se(e.y,t)}}(r,s),l=t.headSvg.viewBox.baseVal,c=function(e,t){const n=t.width/2,r=t.height/2;switch(e){case se.Left:return"scale(-1,1) translate(-100, 0)";case se.Up:return`rotate(-90 ${n} ${r})`;case se.Down:return`rotate(90 ${n} ${r})`;default:return""}}(r.direction,l),d=`${l.x} ${l.y} ${l.width} ${l.height}`,u=Be(t,r),_=Ce(r);return(()=>{const n=Re.cloneNode(!0),l=n.firstChild,f=l.firstChild;return v(l,"viewBox",d),v(l,"x",i),v(l,"y",a),v(l,"width",20),v(l,"height",20),v(l,"fill",u),v(l,"opacity",_),v(f,"transform",c),o(n,(()=>{const n=b((()=>t.effectiveSpace>1),!0);return()=>n()&&(()=>{const t=$e.cloneNode(!0);return v(t,"fill",u),v(t,"opacity",_),e((e=>{const n=function(e){switch(e.direction){case se.Left:return Ve(e.x+1)-4-.2;case se.Right:return Ve(e.x)-4-.2;default:return Ve(e.x)}}(r),i=function(e,t){switch(e.direction){case se.Up:return Se(e.y-1,t)-4-.2;case se.Down:return Se(e.y,t)-4-.2;default:return Se(e.y,t)}}(r,s),o=function(e){return e.direction===se.Left||e.direction===se.Right?4.4:20}(r),a=function(e){return e.direction===se.Left||e.direction===se.Right?20:4.4}(r);return n!==e._v$&&v(t,"x",e._v$=n),i!==e._v$2&&v(t,"y",e._v$2=i),o!==e._v$3&&v(t,"width",e._v$3=o),a!==e._v$4&&v(t,"height",e._v$4=a),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})()})(),null),e((()=>f.innerHTML=t.headSvg.innerHTML)),n})()}(t,0,r,i);case fe.TAIL:return function(t,n,r,s){const i=function(e){switch(e.direction){case se.Left:return Ve(e.x)-.2;case se.Right:return Ve(e.x)+.2;default:return Ve(e.x)}}(r),o=function(e,t){switch(e.direction){case se.Up:return Se(e.y,t)-.2;case se.Down:return Se(e.y,t)+.2;default:return Se(e.y,t)}}(r,s),a=t.tailSvg.viewBox.baseVal,l=function(e,t){const n=t.width/2,r=t.height/2;switch(e){case se.Right:return"scale(-1,1) translate(-100,0)";case se.Down:return`scale(-1,1) translate(-100,0) rotate(-90 ${n} ${r})`;case se.Up:return`scale(-1,1) translate(-100,0) rotate(90 ${n} ${r})`;default:return""}}(r.direction,a),c=`${a.x} ${a.y} ${a.width} ${a.height}`,d=Be(t,r),u=Ce(r);return(()=>{const n=De.cloneNode(!0),r=n.firstChild;return v(n,"viewBox",c),v(n,"x",i),v(n,"y",o),v(n,"width",20),v(n,"height",20),v(n,"fill",d),v(n,"opacity",u),v(r,"transform",l),e((()=>r.innerHTML=t.tailSvg.innerHTML)),n})()}(t,0,r,i);case fe.BODY:return He(t,s)?function(t,n,r,s,i){const o="M0,20 h60 a60,60 0 0 1 60,60 v60 h-100 v-20 h-20 z",a=Be(t,r),l=Ce(r),c="0 0 140 140";let d;switch(function(e,t){if(e.parts[t].type!=fe.BODY)throw new Error("do not call determineCornerType on a non body part");const n=e.parts[t].direction,r=e.parts[t+1].direction;if(n==se.Up&&r==se.Right||n==se.Left&&r==se.Down)return je.TopLeft;if(n==se.Up&&r==se.Left||n==se.Right&&r==se.Down)return je.TopRight;if(n==se.Down&&r==se.Left||n==se.Right&&r==se.Up)return je.BottomRight;if(n==se.Down&&r==se.Right||n==se.Left&&r==se.Up)return je.BottomLeft;throw new Error("unreachable")}(t,s)){case je.BottomRight:d="rotate(270, 70, 70)";break;case je.TopLeft:d="rotate(90, 70, 70)";break;case je.BottomLeft:break;case je.TopRight:d="rotate(180, 70, 70)"}return(()=>{const t=Le.cloneNode(!0),n=t.firstChild;return v(t,"width",28),v(t,"height",28),v(t,"fill",a),v(t,"opacity",l),v(t,"viewBox",c),v(n,"d",o),v(n,"transform",d),e((e=>{const n=function(e){return Ve(e.x)-4}(r),s=function(e,t){return Se(e.y,t)-4}(r,i);return n!==e._v$9&&v(t,"x",e._v$9=n),s!==e._v$10&&v(t,"y",e._v$10=s),e}),{_v$9:void 0,_v$10:void 0}),t})()}(t,0,r,s,i):function(t,n,r,s,i){const o=Be(t,r),a=Ce(r);return(()=>{const t=$e.cloneNode(!0);return v(t,"fill",o),v(t,"opacity",a),e((e=>{const n=function(e){const t=e.direction===se.Left||e.direction===se.Right?-4:0;return Ve(e.x)+t}(r),s=function(e,t){const n=e.direction===se.Up||e.direction===se.Down?-4:0;return Se(e.y,t)+n}(r,i),o=function(e){return 20+(e.direction===se.Left||e.direction===se.Right?8:0)}(r),a=function(e){return 20+(e.direction===se.Up||e.direction===se.Down?8:0)}(r);return n!==e._v$5&&v(t,"x",e._v$5=n),s!==e._v$6&&v(t,"y",e._v$6=s),o!==e._v$7&&v(t,"width",e._v$7=o),a!==e._v$8&&v(t,"height",e._v$8=a),e}),{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),t})()}(t,0,r,0,i)}}function Ye(t){const n=t.frame.snakes||[],r=t.frame.food||[],s=t.frame.hazards||[],i=(a=n,a.concat().sort(((e,t)=>(Ne(e)?0:1)-(Ne(t)?0:1)))).map((e=>de(e)));var a;const l=Array(t.game.height);for(let e=0;e<l.length;e++){l[e]=Array(t.game.width);for(let n=0;n<t.game.width;n++)l[e][n]=!1}for(let e=0;e<i.length;e++){const t=i[e];if(!Ne(t))for(let e=0;e<t.parts.length;e++){const n=t.parts[e];Me(t,n)||(l[n.y][n.x]?n.shadeForOverlap=!0:l[n.y][n.x]=!0)}}const c=24*t.game.width+4,d=24*t.game.height+4,u=parseFloat(Ee);return(()=>{const n=ke.cloneNode(!0);return v(n,"viewBox",`0 0 ${c} ${d}`),o(n,(()=>Ue(t.game.height).map(((n,r)=>Ue(t.game.width).map(((n,s)=>(()=>{const n=$e.cloneNode(!0);return v(n,"width",20),v(n,"height",20),e((e=>{const i=Ve(s),o=Se(r,t.game.height),a=t.theme===xe?ve:ge;return i!==e._v$15&&v(n,"x",e._v$15=i),o!==e._v$16&&v(n,"y",e._v$16=o),a!==e._v$17&&v(n,"fill",e._v$17=a),e}),{_v$15:void 0,_v$16:void 0,_v$17:void 0}),n})()))))),null),o(n,(()=>i.map(((n,r)=>(()=>{const r=De.cloneNode(!0);return o(r,(()=>[...n.parts].reverse().map(((e,r)=>Fe(n,0,e,n.parts.length-r-1,t.game.height))))),e((()=>v(r,"opacity",function(e){return Ne(e)?.1:1}(n)))),r})()))),null),o(n,(()=>r.map((n=>(()=>{const r=Ae.cloneNode(!0);return v(r,"r",Oe),e((e=>{const s=Ve(n.x)+10,i=Se(n.y,t.game.height)+10,o=be;return s!==e._v$18&&v(r,"cx",e._v$18=s),i!==e._v$19&&v(r,"cy",e._v$19=i),o!==e._v$20&&v(r,"fill",e._v$20=o),e}),{_v$18:void 0,_v$19:void 0,_v$20:void 0}),r})()))),null),o(n,(()=>s.map((n=>(()=>{const r=$e.cloneNode(!0);return v(r,"width",20),v(r,"height",20),v(r,"fill-opacity",u),e((e=>{const s=Ve(n.x),i=Se(n.y,t.game.height),o=ye;return s!==e._v$21&&v(r,"x",e._v$21=s),i!==e._v$22&&v(r,"y",e._v$22=i),o!==e._v$23&&v(r,"fill",e._v$23=o),e}),{_v$21:void 0,_v$22:void 0,_v$23:void 0}),r})()))),null),e((e=>{const r=t.maxWidth,s=t.maxHeight,i=t.x,o=t.y;return r!==e._v$11&&v(n,"width",e._v$11=r),s!==e._v$12&&v(n,"height",e._v$12=s),i!==e._v$13&&v(n,"x",e._v$13=i),o!==e._v$14&&v(n,"y",e._v$14=o),e}),{_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0}),n})()}function Ge(e){return g((()=>Ye(e)))()}(Pe=je||(je={}))[Pe.TopLeft=0]="TopLeft",Pe[Pe.TopRight=1]="TopRight",Pe[Pe.BottomRight=2]="BottomRight",Pe[Pe.BottomLeft=3]="BottomLeft";var qe="_Board_1sfia_1";const ze=t("<div></div>");function We(t){const[r,a]=n(t,["frame","game","theme"]);return(()=>{const t=ze.cloneNode(!0);return i(t,a,!1,!0),o(t,s(Ge,y(r,{maxWidth:300,maxHeight:300,x:0,y:0}))),e((()=>t.className=qe)),t})()}const Xe=t('<label><input type="checkbox"></label>'),Je=t("<br>"),Ke=t('<div><span>Game ID:</span><input class="py-0 rounded border-gray-400 mx-2" type="text"><button class="bg-blue-400 text-white px-2 font-bold rounded">Import game</button></div>'),Qe=t('<div><span class="inline-block w-1/3">test description:</span><input class="inline-block w-3/6 py-0 rounded border-gray-400 ml-2" type="text"></div>'),Ze=t('<div><span class="inline-block w-1/3">frame to test:</span><input class="inline-block w-3/6 py-0 rounded border-gray-400 ml-2" type="number"></div>'),et=t("<div><span>snake to test:</span><br></div>"),tt=t("<div><span>expected direction(s):</span><br></div>"),nt=t("<div><span>your answer: <!> </span></div>"),rt=t('<div><button class="bg-blue-400 text-white px-2 font-bold rounded">Run test</button><button class="bg-blue-400 text-white px-2 ml-2 font-bold rounded">Save test</button></div>'),st=t('<div class="m-4 p-4 bg-white"><h3 class="text-lg text-gray-700">Game importer</h3><div class="flex my-4"><div class="space-y-2"></div><div></div></div></div>'),it=t('<label><input type="radio" name="snakeToTest"> (<!>)</label>');function ot(t){const[n,r]=E({gameId:"",frameToTest:0,game:void 0,frames:[],snakeToTest:0,description:"",expectedResult:[],testAnswer:""}),i=e=>r("expectedResult",e);const a=g((()=>{if(n.frames.length>0){const e=n.frames[n.frameToTest].snakes,t=n.frames[n.frames.length-1].snakes,r=[];for(let n=0;n<e.length;n++){const s=t[n].death;r.push({name:e[n].name,deathInfo:s?`rip in turn ${s.turn}`:"winner",isDeathNow:!!e[n].death})}return r}return[]})),c=()=>{const e=n[x];if(!e)return;const t=e.game,r=e.frames,s=e.snakeToTest;if(t&&r&&s>=0){const n=r[r.length-1],i=n.snakes[s],o=i.death&&i.death.turn||n.turn;return{id:T(10),description:e.description,timestamp:Date.now(),game:t,frames:r.filter((t=>t.turn>=e.frameToTest&&t.turn<=o)),frameToTest:e.frameToTest,snakeToTest:e.snakeToTest,expectedResult:e.expectedResult}}},d=t=>{const n=g((()=>{const e=t.items().map((()=>!1));return t.items().forEach((n=>{const r=t.options.findIndex((e=>e==n));r>=0&&(e[r]=!0)})),e}));return s(w,{get each(){return t.options},children:(r,s)=>[(()=>{const i=Xe.cloneNode(!0),a=i.firstChild;return a.addEventListener("change",(()=>(e=>{const r=n();r[e]=!r[e];const s=t.options.filter(((e,t)=>r[t]));t.setItems(s)})(s()))),a.value=r,o(i,(()=>r.toLowerCase()),null),e((()=>a.checked=(e=>n()[e])(s()))),i})(),Je.cloneNode(!0)]})};return(()=>{const u=st.cloneNode(!0),_=u.firstChild.nextSibling.firstChild,f=_.nextSibling;return o(_,s(l,{get when(){return!n.game},get children(){const t=Ke.cloneNode(!0),s=t.firstChild.nextSibling,i=s.nextSibling;return s.addEventListener("blur",(e=>r("gameId",e.target.value))),i.$$click=()=>(async()=>{const e=await re(n.gameId),t=e.frames[0];await ce(t.snakes),r({game:e.game,frames:e.frames,frameToTest:0,description:"",snakeToTest:0,expectedResult:[],testAnswer:""})})(),e((()=>s.value=n.gameId)),t}}),null),o(_,s(l,{get when(){return n.game},get children(){return[(()=>{const t=Qe.cloneNode(!0),s=t.firstChild.nextSibling;return s.addEventListener("blur",(e=>r("description",e.target.value))),e((()=>s.value=n.description)),t})(),(()=>{const t=Ze.cloneNode(!0),s=t.firstChild.nextSibling;return s.$$input=e=>function(e){const t=e.target,s=""!=t.value.trim()?+t.value:0,i=n.frames.length,o=Math.max(0,Math.min(s,i-1));t.value=""!=t.value.trim()?o.toString():"",r("frameToTest",o)}(e),e((()=>s.value=n.frameToTest)),t})(),(()=>{const t=et.cloneNode(!0);return t.firstChild.nextSibling,o(t,s(w,{get each(){return a()},children:(t,s)=>[(()=>{const i=it.cloneNode(!0),a=i.firstChild,l=a.nextSibling,c=l.nextSibling;return c.nextSibling,a.addEventListener("change",(e=>function(e){const t=e.target;t.checked&&r("snakeToTest",+t.value)}(e))),o(i,(()=>t.name),l),o(i,(()=>t.deathInfo),c),e((e=>{const r=t.isDeathNow?.4:1,o=s(),l=n.snakeToTest==s(),c=t.isDeathNow;return r!==e._v$&&i.style.setProperty("opacity",e._v$=r),o!==e._v$2&&(a.value=e._v$2=o),l!==e._v$3&&(a.checked=e._v$3=l),c!==e._v$4&&(a.disabled=e._v$4=c),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),i})(),Je.cloneNode(!0)]}),null),t})(),(()=>{const e=tt.cloneNode(!0);return e.firstChild.nextSibling,o(e,s(d,{options:["Up","Down","Left","Right"],items:()=>n.expectedResult,setItems:i}),null),e})(),s(l,{get when(){return n.testAnswer},get children(){const e=nt.cloneNode(!0),t=e.firstChild,r=t.firstChild.nextSibling;return r.nextSibling,o(t,(()=>n.testAnswer),r),e}}),(()=>{const e=rt.cloneNode(!0),n=e.firstChild,s=n.nextSibling;return n.$$click=()=>(async()=>{const e=c();if(e){const n=await he(`${t.server()}/move`,e);r("testAnswer",n.move||n.msg)}})(),s.$$click=()=>(()=>{const e=c();e&&t.saveTest(e)})(),e})()]}}),null),o(f,s(l,{get when(){return n.game},children:e=>s(We,{game:e,get frame(){return n.frames[n.frameToTest]},get theme(){return t.theme}})})),u})()}c(["click","input"]);const at=t("<span></span>"),lt=t('<span style="color:green"></span>'),ct=t('<span style="color:red"></span>'),dt=t('<div class="flex flex-col m-4 p-4 bg-white"></div>'),ut=t('<div class="my-2"><h3 class="text-lg text-gray-700"></h3></div>'),_t=t('<div class="flex items-start flex-wrap"><div class="inline-block"><div><span>turn:</span><input class="py-0 w-24 text-center focus:ring-0 border-none" type="number"></div></div><table></table></div>'),ft=t('<div><p>Expected: </p><p>Your Answer: <!> </p><button class="bg-blue-400 text-white my-2 px-2 font-bold rounded">Run Test</button></div>'),mt=t('<tr class=""><td class="pr-2 py-1" style="font-size:0"></td><td>length:</td><td class="px-2 text-right tabular-nums"></td><td>health:</td><td class="px-2 text-right tabular-nums"></td></tr>');function pt(t){const n=t.mySnakeStyle,r=t.testResult,[i,a]=R(null),[c,f]=R(0);d((async()=>{const e=r().id,n=await t.readTest(e),s=n.frames[0].snakes;await ce(s),D((()=>{f(n.frameToTest),a(n)}))}));const m=g((()=>{const e=i(),t=null==e?void 0:e.frames.find((e=>e.turn==c()));if(e&&t){const r=[...t.snakes];return Object.assign(r[e.snakeToTest],n()),{...t,snakes:r}}})),p=g((()=>{const e=i(),t=m();if(e&&t){const n=e.frames,r=n[n.length-1],s=r.snakes.map((e=>e.death?e.death.turn:r.turn+1)),i=$(t.snakes,s);return L((e=>-e[1]),i).map((e=>e[0]))}return[]})),h=e=>{const t=g((()=>e.testResult.result));function n(e,t){return!!t(e)&&e}const r=e=>"passed"==e.type,i=e=>"failed"==e.type,a=e=>"pending"==e.type;return s(_,{get children(){return[s(u,{get when(){return n(t(),a)},get children(){return at.cloneNode(!0)}}),s(u,{get when(){return n(t(),r)},children:e=>(()=>{const t=lt.cloneNode(!0);return o(t,(()=>e.move)),t})()}),s(u,{get when(){return n(t(),i)},children:e=>(()=>{const t=ct.cloneNode(!0);return o(t,(()=>e.move||e.msg)),t})()})]}})};return(()=>{const n=dt.cloneNode(!0);return o(n,s(l,{get when(){return!!(e=[r(),i(),m()]).every((e=>!!e))&&e;var e},children:([n,r,a])=>[(()=>{const e=ut.cloneNode(!0),t=e.firstChild;return o(t,(()=>r.description)),e})(),(()=>{const n=_t.cloneNode(!0),l=n.firstChild,c=l.firstChild,d=c.firstChild.nextSibling,u=l.nextSibling;return o(l,s(We,{get game(){return r.game},frame:a,get theme(){return t.theme}}),c),d.$$input=e=>(e=>{const t=i();if(t){const n=e.target,r=""!=n.value.trim()?+n.value:0,s=t.frames[0].turn,i=t.frames[t.frames.length-1].turn,o=Math.max(s,Math.min(r,i));n.value=""!=n.value.trim()?o.toString():"",f(o)}})(e),o(u,s(w,{get each(){return p()},children:t=>(()=>{const n=mt.cloneNode(!0),r=n.firstChild,i=r.nextSibling.nextSibling,a=i.nextSibling.nextSibling;return o(r,s(z,{get color(){return t.color},get head(){return t.headType},get tail(){return t.tailType}})),o(i,(()=>t.body.length)),o(a,(()=>t.health)),e((()=>n.style.setProperty("opacity",t.death?.2:1))),n})()})),e((()=>d.value=r.frameToTest)),n})(),(()=>{const e=ft.cloneNode(!0),i=e.firstChild;i.firstChild;const a=i.nextSibling,l=a.firstChild.nextSibling;l.nextSibling;const c=a.nextSibling;return o(i,(()=>r.expectedResult.join(" or ")),null),o(a,s(h,{testResult:n}),l),c.$$click=()=>t.runSingleTest(r.id),e})()]})),n})()}c(["input","click"]);const ht=t('<div class="flex flex-col w-full"><div class="flex flex-0 justify-between mb-4"><p class="font-bold text-gray-500">Tests available:</p><button class="bg-blue-400 text-white px-2 font-bold rounded">Run all tests</button></div><div class="overflow-y-scroll"><ul></ul></div></div>'),gt=t('<svg class="flex-shrink-0 inline-block w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="12" fill="#D9D9D9"></circle></svg>'),vt=t('<svg class="flex-shrink-0 inline-block w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="12" fill="#A7F3D0"></circle><path d="M18 8l-8 8-4-4" stroke="#047857" stroke-width="2"></path></svg>'),bt=t('<svg class="flex-shrink-0 inline-block w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="12" fill="#FECDD3"></circle><path d="M8 8l8 8M16 8l-8 8" stroke="#B91C1C" stroke-width="2"></path></svg>'),yt=t('<li class="flex items-center px-2 py-2 font-medium leading-5"><span class="truncate"></span></li>');function Et(t){const[n,r]=t.selected,i=t.setView,a=t.testResults,l=k(n);return(()=>{const n=ht.cloneNode(!0),c=n.firstChild,d=c.firstChild.nextSibling,f=c.nextSibling.firstChild;return A(d,"click",t.runAllTests,!0),o(f,s(w,{get each(){return a()},children:(t,n)=>(()=>{const a=yt.cloneNode(!0),c=a.firstChild;return a.$$click=()=>{return e=n(),void D((()=>{r(e),i("test")}));var e},o(a,s(_,{get children(){return[s(u,{get when(){return"pending"==t.result.type},get children(){return gt.cloneNode(!0)}}),s(u,{get when(){return"passed"===t.result.type},get children(){return vt.cloneNode(!0)}}),s(u,{get when(){return"failed"===t.result.type},get children(){return bt.cloneNode(!0)}})]}}),c),o(c,(()=>t.description)),e((()=>a.classList.toggle("bg-yellow-100",l(n())))),a})()})),n})()}c(["click"]);const wt=function(){const e="Tests",t=O("TestStorage",1,{upgrade(t){t.createObjectStore(e,{keyPath:"id"})}}),n=[],r=(e,t)=>n.forEach((n=>n(e,t)));return{async list(){const n=await t;let r=await n.transaction(e).store.openCursor();const s=[];for(;r;)s.push({id:r.value.id,description:r.value.description,timestamp:r.value.timestamp}),r=await r.continue();return L((e=>e.timestamp),s)},async save(n){const s=(await t).transaction(e,"readwrite").objectStore(e);await s.add(n),r(void 0,n)},async remove(n){const s=(await t).transaction(e,"readwrite").objectStore(e),i=await s.get(n);await s.delete(n),r(i,void 0)},read:async n=>(await t).transaction(e).objectStore(e).get(n),suscribe(e){n.push(e)}}}(),[xt,Tt]=E({server:"http://localhost:8080",testedSnake:{style:void 0},testResults:[],selected:0,view:"test"});wt.list().then((e=>{const t=e.map((e=>({...e,result:{type:"pending"}})));Tt("testResults",t)})),wt.suscribe(((e,t)=>{if(!e&&t){const e={id:t.id,description:t.description,timestamp:t.timestamp,result:{type:"pending"}};Tt("testResults",(t=>[...t,e]))}}));const Rt=g((()=>xt.testResults[xt.selected]));async function $t(e){const t=await wt.read(e),n=await he(`${xt.server}/move`,t),r=xt.testResults.findIndex((t=>t.id==e));return r>=0&&Tt("testResults",r,"result",n),n}async function Lt(){const e=xt.testResults.map((e=>e.id)),t=e.map((e=>wt.read(e))).map((e=>e.then((e=>he(`${xt.server}/move`,e))))),n=await Promise.all(t),r=xt.testResults.map((t=>{const r=e.indexOf(t.id);return r>=0?{...t,result:n[r]}:t}));Tt("testResults",r)}const Dt=e=>wt.save(e),kt=e=>wt.read(e);function At(e){return function(e,t,n){const r=n.split(".");return[()=>{let t=e;for(let e=0;e<r.length;e++)if(t=t[r[e]],null==t){if(e!==r.length-1)return;break}return t},e=>t.call(null,...r,e)]}(xt,Tt,e)}const Ot=t('<div class="flex flex-col h-screen"><header><div class="p-4" style="background-color:#72268c;"><h1 class="text-center text-white text-2xl font-semibold tracking-wide">Battlesnake Tester</h1></div><div class="p-4 bg-white" style="box-shadow:0 1px 1px 1px rgb(18 106 211 / 8%);"></div></header><div class="flex flex-1 flex-row mt-1 overflow-hidden"><aside class="flex bg-white w-80 p-4"></aside><main class="flex-1 p-4"><div class="flex"></div></main></div></div>'),It=()=>{const[e,t]=At("server"),[n,r]=At("view"),[i,a]=At("testResults"),[l,c]=At("testedSnake.style"),d=At("selected");return(()=>{const a=Ot.cloneNode(!0),f=a.firstChild,m=f.firstChild.nextSibling,p=f.nextSibling.firstChild,h=p.nextSibling.firstChild;return o(m,s(Q,{server:[e,t],style:[l,c],setView:r})),o(p,s(Et,{get runAllTests(){return Lt},selected:d,setView:r,testResults:i})),o(h,s(_,{get children(){return[(()=>{const e=b((()=>"test"==n()),!0);return s(u,{get when(){return e()&&Rt()},get children(){return s(pt,{mySnakeStyle:l,get theme(){return Te},get testResult(){return Rt},get runSingleTest(){return $t},get readTest(){return kt}})}})})(),s(u,{get when(){return"importer"==n()},get children(){return s(ot,{get theme(){return Te},server:e,get saveTest(){return Dt}})}})]}})),a})()},jt=document.getElementById("root");jt&&I((()=>s(It,{})),jt);
